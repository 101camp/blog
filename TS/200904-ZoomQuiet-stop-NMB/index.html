
<!DOCTYPE html>
<html>
<head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>呢喃/ NMB无法终止 &mdash; 蟒营™ 怂怼录</title>

    <link rel="shortcut icon" href="../../img/favicon.ico">
    <link rel="stylesheet" href="../../css/alabaster.css" type="text/css">
    <link rel="stylesheet" href="../../css/alabaster-overrides.css" type="text/css">

    

    
      <script src="../../search/main.js"></script>
    

    

    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

    
  


<!--
190916 ++tongji.baidu
-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7b96768fb6a5e86ac53eae70bb5fd60b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body>

  <div class="document">
    <div class="documentwrapper">
      <div class="bodywrapper">
        <div class="body" role="main">
          
            <h1 id="nmb">呢喃/ NMB无法终止<a class="headerlink" href="#nmb" title="Permanent link">¶</a></h1>
<blockquote>
<p>记一次失败的系统配置</p>
</blockquote>
<p>这是大妈在 <strong>ZoomQuiet</strong> 的第<strong>061</strong>篇原创</p>
<hr />
<h2 id="_1">背景<a class="headerlink" href="#_1" title="Permanent link">¶</a></h2>
<p>大妈虽然学的是计算系,
但是, 当年电脑非常贵,
大学期间到大三, 才和同舍合资买了电脑,
因为出次最少, 平时上机还是排队去机房为多.</p>
<p>真正有私人电脑是毕业3年后了.</p>
<p>所以, 对于自用电脑的系统是有洁癖的;</p>
<p>当年 Windows 系统, 无论 98/XP/NT/... 那都是一言不合立即重装的,
毕竟, 必要软件和数据, 早已习惯分布在其它专用分区中,
系统所在 C 盘, 每42天 重装就感觉已经在变慢.</p>
<p>进而后来使用 Ubuntu/macOS 也都有定期检查系统健康情况的习惯.</p>
<hr />
<h2 id="_2">现象<a class="headerlink" href="#_2" title="Permanent link">¶</a></h2>
<p>11年开始, 终于日常环境切换到 macOS 了,
也将原先 Ubuntu 环境中积累的各种习惯配置迁移过来,
特别是 输入法/浏览器/定制 bash  三大日常操作, 都兼容了老习惯.</p>
<p>只是毕竟 macOS 是魔改 freeBSD, 
和 windows 类似, 还是有很多暗角, 在不知不觉中占用多余空间.</p>
<p>又不信任那些自动优化空间的收费软件,
所以, 一般是用 <code>OmniDiskSweeper</code> 免费空间统计工具:</p>
<p><img alt="OmniDiskSweeper" src="http://ydlj.zoomquiet.top/ipic/2020-09-04-ScreenShot%202020-09-04%2011.22.12.jpg" /></p>
<p>可以说就是一个 GUI 化的自动多层排序 <strong>du - estimate file space usage</strong> 工具.</p>
<p>结果发现:</p>
<pre><code>/opt/local/var/log.nmbd
</code></pre>
<p>竟然有8G 之巨.</p>
<hr />
<h2 id="_3">问题<a class="headerlink" href="#_3" title="Permanent link">¶</a></h2>
<p>追查内容发现:</p>
<pre><code>...
[2020/09/04 11:06:04,  0] nmbd/nmbd.c:main(849)
  nmbd version 3.2.15 started.
  Copyright Andrew Tridgell and the Samba Team 1992-2009
[2020/09/04 11:06:04,  0] nmbd/nmbd.c:main(879)
  standard input is not a socket, assuming -D option
[2020/09/04 11:06:04,  0] lib/util_sock.c:open_socket_in(1336)
  bind failed on port 137 socket_addr = 0.0.0.0.
  Error = Address already in use
[2020/09/04 11:06:14,  0] nmbd/nmbd.c:main(849)
  nmbd version 3.2.15 started.
...
</code></pre>
<p>都是相同的服务失效报告;</p>
<p>将日志文件删除, 不一会儿, 又自动生成, 稳定增长.</p>
<hr />
<h2 id="_4">尝试<a class="headerlink" href="#_4" title="Permanent link">¶</a></h2>
<p>看意思只是 Smaba 启动时, 依赖的 nmbd 无法启动, 因为对应端口已经被占用了.</p>
<p>可是, 根据自己平时使用情况, 根本用不上 Smaba 这种东西,
有太多更加方便和安装的协议可以同 Windows 系统交换文件了.</p>
<p>那么, 解决这种无限增长的服务日志, 嘦停止不必要的服务就好.</p>
<p>参考了:</p>
<p><a href="https://superuser.com/questions/349717/how-to-start-samba-on-mac-os-x-from-terminal">macos - How to start SAMBA on MAC OS X from Terminal? - Super User</a> </p>
<p><a href="https://gist.github.com/TomCan/7182edff81937687432f">Restart Mac OS X smb service from terminal/cli</a></p>
<p><a href="https://discussions.apple.com/thread/3050861">How do I restart samba on OSX 10.6.7? - Apple Community</a></p>
<p><a href="http://mirror.informatimago.com/next/developer.apple.com/documentation/Darwin/Conceptual/howto/osx_smb/osx_smb.html">Mac OS X and SMB HOWTO</a> </p>
<p>...</p>
<p>也通过相关指令, 明确的确是 Smanba 相关服务在运行:</p>
<pre><code>༄  netstat -l -n | grep 137
udp4       0      0  *.137                  *.*

༄  sudo lsof -i:137
COMMAND    PID     USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
launchd      1     root   17u  IPv4 0x4f6330094fadbb51      0t0  UDP *:netbios-ns
netbiosd 75859 _netbios    3u  IPv4 0x4f6330094fadbb51      0t0  UDP *:netbios-ns
</code></pre>

<p>但是, 神奇的是:</p>
<p>无论俺如何在配置界面中关闭所有文件共享,
还是用指令关闭所有相关服务;</p>
<p>每隔10秒, 这个日志又开始增长了,而且报错信息不变...</p>
<hr />
<h2 id="_5">结果<a class="headerlink" href="#_5" title="Permanent link">¶</a></h2>
<p>折腾了几个星期, 找到所有相关指令, 能作到用 sudo 身份关闭服务后,
日志的确不再增长.</p>
<p>可是休眠/重启/..等等系统相关操作后,
不知道为什么日志又开始增长.</p>
<p>也就是说, Samba 不知道被哪个软件又给启动了.</p>
<p>因为硬件关系, 又不想升级 macOS 到最新版本, 坚守在最兼容当前硬件的 <strong>10.12.6 (16G2136)</strong>;</p>
<p>平时, 也真的没有任何 Smaba 使用场景, 
这事儿如何解决呢?</p>
<p>突然想到, 既然 Samba 不必要, 但是, 又无法真正删除/停止;</p>
<p>那么对于俺的影响, 无非是额外硬盘空间被占用.</p>
<p>那么, 定期自动化清空无法阻止的日志文件不就好了?</p>
<pre><code>42 * * * * echo '' &gt; /opt/local/var/log.nmbd
</code></pre>

<p>追加一个定期任务到 <code>crontab</code> 中,
哗...世界清静了.</p>
<p>PS:</p>
<p>所以, 太多时候,
我们尝试解决的问题, 
其实只是真实问题的一个直觉方案,
而不是问题本身;</p>
<p>这在软件行业中叫 <code>X-Y 问题</code>;</p>
<p>如何从这种惯性思维中挣脱出来?</p>
<p>说不得, 当然: <strong>蟒营®编程思维提高班 Python版/</strong> 就是一个很好的训练和呢喃背景.</p>
<hr />
<blockquote>
<p>本人公号所刊载原创内容之知识产权为本人所有,
未经许可, 禁止进行转载/摘编/复制及建立镜像等任何使用.
欢迎读者沟通交流, 请留言, 或通过邮件交流-&gt;</p>
</blockquote>
<p>投稿/反馈邮箱:</p>
<pre><code>askdama@googlegroups.com
</code></pre>
<p>(邮件列表地址, 
当成正常邮件发送邮件就好, 不用订阅, 不用翻越...)</p>
<hr />
<p>ZoomQuiet/<strong><a href="https://mp.weixin.qq.com/s/N5TuRRbF485D4Q90XdDA7g">大妈</a></strong></p>
<p>就是四处 <code>是也乎,(￣▽￣)</code> 的那个<a href="https://mp.weixin.qq.com/s/N5TuRRbF485D4Q90XdDA7g">大妈</a>:</p>
<pre><code class="python">
私自嗯哼: ZoomQuiet (订阅号: ZoomQuiet42)
原创课程: 蟒营 (订阅号: Mainium)
过往吐糟: Chaos42 (订阅号 PythoniCamp)

as 核心组织者:
    PyChina (订阅号: PyChinaOrg)
    本地社区: 
        GDG珠海 (订阅号: GDG-ZhuHai)
        TFUG珠海 (订阅号: ZH_TFUG)
</code></pre>

<hr />
<p>好文笔,感叹号年度配额: <strong>1/3</strong></p>
<blockquote>
<p>NN 4126</p>
</blockquote>
            
<!--
            

-->

            <!--190910 init. comments-->
<hr/>
            <script src="https://utteranc.es/client.js"
        repo="101camp/comments"
        issue-term="url"
        label="✨💬✨ "
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

<hr/>

            <hr/>

<h4>自怼圈/年度番新</h4>
<img alt="DU22.4" 
    src="https://ipic.zoomquiet.top/2022-03-31-220331DU6y_zip.jpg!/fw/420"/>
<br/>
<a href="https://du.101.camp/about/">关于 ~ DebugUself with DAMA ;-)</a>


<!--
![](https://ipic.zoomquiet.top/2022-03-31-220331DU6y_zip.jpg)
<h3>蟒营®编程思维提高班 Python版/<b>第14期</b> 正在报名</h3>
<h4>精品小班/ 永久答疑</h4>

<blockquote><p>
    
<ul>
    <li>
    开始报名: <b>2020.10.27</b> </li>
    <li>
    报名截止: <b>2020.11.22</b> </li>
    <li>
    正式开课: <b>2020.11.29</b> </li>
    <li>
    课程结束: <b>2021.01.10</b> </li>

    <li>
    介绍文章:  
    <ul>
        <li>
<a href="https://blog.101.camp/nc/200811-ZoomQuiet-wtf-coding-mind/">蟒营®/ 为什么编程思维不用学就有?</a>
        </li>

        <li>
<a href="https://blog.101.camp/nc/200816-ZoomQuiet-wtf-online-course/">拙见/ 什么是网课?</a>
        </li>

        <li>
<a href="https://blog.101.camp/nc/200908-ZoomQuiet-fake-learnning/">蟒营®/ 伪编程学习</a>
        </li>

        <li>
<a href="https://blog.101.camp/nc/200915-ZoomQuiet-3not-see/">蟒营®/ 视而不见</a>
        </li>

        <li>
<a href="https://blog.101.camp/nc/200917-ZoomQuiet-3not-ask/">蟒营®/ 惑而不问</a>
        </li>

        <li>
<a href="https://blog.101.camp/nc/200918-ZoomQuiet-3not-learn/">蟒营®/ 思而不学</a>
        </li>

        <li>
<a href="https://blog.101.camp/nc/200630-ZoomQuiet-10py-wtf-can-coding/">蟒营®/ 到底如何算"会编程"?</a>
        </li>

        <li>
<a href="https://blog.101.camp/nc/200703-ZoomQuiet-10py-wtfc-0/">蟒营®/ 到底改变了什么?</a>
        </li>

        <li>
...<a href="https://blog.101.camp/nc/">NC: 嗯哼蟒营 — 蟒营™ 怂怼录</a>
        </li>
    </ul>
    </li>


</ul>

<b>扫描</b>报名:

<a href="https://jinshuju.net/f/Mv5nGU">
<img alt="101camp14py" 
    src="http://101.zoomquiet.top/res/14py/%E8%9F%92%E8%90%A5%C2%AE%E7%BC%96%E7%A8%8B%E6%80%9D%E7%BB%B4%E6%8F%90%E9%AB%98%E7%8F%AD_14%E6%9C%9F_%E6%8A%A5%E5%90%8D%E8%A1%A8_256.png"/>
</a>
</p></blockquote>


<h2>蟒营®式 原创课程</h2>
<p>

<img alt="theory101camp_v3" 
    src="http://ydlj.zoomquiet.top/ipic/2020-10-04-theory101camp_v3.jpg"/>

</p>

<blockquote>
<p>
    官网: <b>
    <a href="https://py.101.camp/">py.101.camp</a>
    </b>
</p>
</blockquote>



<br/>
任何问题可先进入知识星球<b>(免费)</b>咨询:
<br/>
<img alt="FAQ" 
    src="http://ydlj.zoomquiet.top/ipic/2020-02-28-FAQ101camp-qr.jpeg?imageView2/2/w/360"/>

-->


<hr/>
点击注册~> 获得 <b>100$</b> 体验券:
<a href="https://www.digitalocean.com/?refcode=e7b7cdc66376&utm_campaign=Referral_Invite&utm_medium=Referral_Program&utm_source=badge"><img src="https://web-platforms.sfo2.digitaloceanspaces.com/WWW/Badge%202.svg" alt="DigitalOcean Referral Badge" /></a>

<hr/>


<p>订阅 substack 体验古早写作:
    <br/>

<iframe src="https://zoomquiet.substack.com/embed" width="480" height="320" style="border:1px solid #EEE; background:white;" frameborder="0" scrolling="no"></iframe>

</p>

<hr/>

<p>关注公众号, 持续获得相关各种嗯哼:
    <br/>
<img alt="zoomquiet" 
    src="https://ipic.zoomquiet.top/2021-12-27-zoomquiet-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88580.jpg"/>
</p>



<!--

    ![](https://ipic.zoomquiet.top/2022-03-31-2020-10-21-zoomquiet-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88580.jpg)
<blockquote><p>
    
<ul>
    <li>
<a href="https://mp.weixin.qq.com/s/FqDJWQQcthEuGHAPPEzUKA">
拙见/ 但得呢喃
    </a></li>

    <li>
<a href="https://mp.weixin.qq.com/s/Hvu22TO1HKK2H8rnbPWcig">
拙见/ 但得呢喃+1
    </a></li>
    <li>
<a href="https://mp.weixin.qq.com/s/w7m2BwIDsntnLl2vCDuP9g">
拙见/ 但得呢喃+2
    </a></li>
    <li>
<a href="https://mp.weixin.qq.com/s/HXXfikoYfGV4zqf8-oOlgw">
拙见/ 但得呢喃+3
    </a></li>
    <li>
<a href="https://mp.weixin.qq.com/s/uFdOHc_u9SqHPKhW9qXz7g">
拙见/ 但得呢喃+4
    </a></li>
    <li>
<a href="https://mp.weixin.qq.com/s/CZUUmuZ2tDZU0gRAyTHz5w">
拙见/ 如此平庸又如此美好
    </a></li>
    <li>
<a href="https://mp.weixin.qq.com/s/A-javC9noWxEUeTDaJoWiw">
拙见/ 如何开始弛放?
    </a></li>


</ul>
</p></blockquote>


-->


<hr/>
<h3>蟒营®编程思维提高班Python版</h3>
**2021.01.11** 因大妈再次创业暂停定期开设, 转换为预约触发:

<!--
<ul>
    <li>
+ 扫描预约入群, 学员每满 42 人即启动新一期训练营 ;-)
    </li>

    <li>
<img alt="101camp21.7" 
    src="http://ydlj.zoomquiet.top/ipic/2021-07-20-210704camp-pre-order_zip.jpg"/>
    </li>
    <li>
+  任何问题, 随时邮件提问可也:<pre>askdama@googlegroups.com</pre>
    </li>
</ul>

-->

<h4>追问</h4>
<blockquote>
<p>
    任何问题, 随时邮件提问可也:
<br/>
    <i>
    askdama@googlegroups.com
    </i>
</p>
</blockquote>

          
        </div>
      </div>
    </div>
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
      <div class="sphinxsidebarwrapper">
        
          
            
  <p class="logo">
    <a href="../..">
      <img class="logo" src="../../logo-owlook.png" title="蟒营™ 怂怼录">
    </a>
  </p>
  



          
            



<h3>Table Of Contents</h3>

<nav>
  
  
    <ul>
    
      <li><a href="#_1">背景</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#_2">现象</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#_3">问题</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#_4">尝试</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#_5">结果</a></li>
      <ul>
    
  </ul>
    
  </ul>
  

  
    <hr>
    <ul>
      
      <!--
        <li class="toctree-l1"><a href="https://github.com/101camp/blog">edit➔GitHub</a></li>
      -->
        <li class="toctree-l1"><a href="https://github.com/101camp/blog/tree/master/docs/TS/200904-ZoomQuiet-stop-NMB.md">edit➔GitHub</a></li>

      
    </ul>
  
</nav>
          
            

          
            <!--
<div id="searchbox" style="display: none;" role="search">
  <h3>Quick search</h3>
  <form class="search" action="../../search.html" method="get">
    <input name="q" type="text">
    <input value="Go" type="submit">
  </form>
  <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
  </p>
</div>
<script type="text/javascript">
  document.getElementById("searchbox").style.display = "block";
</script>

-->
          
        

        <!--190910 init. comments-->
        <h3>Columns</h3>
<ul>
    <li><a href="/DM/">DM 大妈嗯哼</a></li>
    <li><a href="/NC/">NC 嗯哼蟒营</a></li>
    <li><a href="/SS/">SS 学员故事</a></li>
    <li><a href="/TS/">TS 技术鳮汤</a></li>
</ul>



<h4>Powered by</h4>
<ul>
    <li>
        <a href="https://101.camp/">蟒营®<br/>课程框架</a>
<ul>
    <li>
        <a href="https://py.101.camp/">编程思维<br/>提高班</a>
    </li>
    <li>
        <a href="https://github.com/101camp/comments/issues">评注</a>
    </li>
    <li>
        <a href="https://io.101.camp/">图谱</a>
    </li>
    <li>
        <a href="https://slides.101.camp/">幻灯</a>
    </li>
    <li>
        <a href="https://wiki.101.camp/">维基</a>
    </li>
</ul>
    </li>

    <li>
        <a href="https://du.101.camp/">自怼圈</a>
    </li>
    <li>
        <a href="https://du.101.camp/duw/">怼周刊</a>
    </li>

    <li>
        <a href="http://weekly.pychina.org/">蟒周刊</a>
    </li>
    <li>
        <a href="https://blog.zhgdg.org/">珠海GDG</a>
    </li>
    <li>
        <a href="http://zh.tfug.world/">TFUG珠海</a>
    </li>
    <li>
        "大妈"们
<ul>
    <li>
        <a href="https://yixuan.li/">Yixuan</a>
    </li>

    <li>
        <a href="https://www.douban.com/people/Azeril/">Azeril</a>
    </li>
    <li>
        <a href="https://zoomquiet.io/">Zoom.Quiet</a>
    </li>
    <li>
        ...
    </li>
</ul>
    <li>
        <a href="http://mainium.icu">昧因科技®</a>
    </li>
    <li>
        <a href="https://www.vultr.com/?ref=8333895">vultr</a>
    </li>    
    <li>
    已由
<br/>
        <a href="http://www.upyun.com/">
        <img src="http://docs.upyun.com/img/upyun_logo.png"
        width="90">

<!--
        <a href="http://qiniu.com/">
        <img src="https://www.qiniu.com/assets/logo-zh-dbef5f389fb045c60f710d4d4e6225e9015c1684b1a1f7b81e000b952581dcd4.png"
        width="90">
-->        
        </a>
<br/>
    提供CDN及云存储服务

    </li>    
</ul>


      </div>
    </div>
    <div class="clearer"></div>
  </div>

  
    <div class="footer">
      
        &copy; 蟒营™101camp
      
      
        |
        Powered by <a href="http://www.mkdocs.org">mkdocs 1.0.4</a>
        &amp; <a href="https://github.com/iamale/mkdocs-alabaster">mkdocs-alabaster</a>

        <hr/>
点击注册~> 获得 <b>100$</b> 体验券:
<a href="https://www.digitalocean.com/?refcode=e7b7cdc66376&utm_campaign=Referral_Invite&utm_medium=Referral_Program&utm_source=badge"><img src="https://web-platforms.sfo2.digitaloceanspaces.com/WWW/Badge%202.svg" alt="DigitalOcean Referral Badge" /></a>

<hr/>

      
    </div>
  

  <!--
  MkDocs version      : 1.0.4
  Docs Build Date UTC : 2022-04-01 01:48:00
  -->
</body>
</html>